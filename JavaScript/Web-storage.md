# 1. 웹 스토리지란?

- 클라이언트 컴퓨터에 데이터를 저장하는 매커니즘을 말한다.
- 웹 사이트의 성능에 영향을 주지 않고 많은 양의 데이터를 저장할 수 있다.
- 쿠키보다 안전하고 속도도 빠르다.
- 쿠키는 서버로 요청할 때마다 매번 HTTP 요청 헤더에 붙여서 전송해야 하기 때문에 네트워크에 상당한 부담이 된다.

# 2. 종류

웹 스토리지에는 데이터를 저장하기 위한 두 종류의 객체 `localStorage`와 `sessionStorage`가 있다. 둘은 HTML5에 추가된 저장소이며, 간단한 키와 값을 저장할 수 있다. `key-value` 저장소의 형태이다.

`localStorage`와 `sessionStorage`의 차이점은 **데이터의 영구성**이다. 로컬 스토리지의 데이터는 사용자가 지우지 않는 이상 계속 브라우저에 남아 있습니다. 하지만 세션 스토리지의 데이터는 윈도우나 브라우저의 탭을 닫을 경우 제거됩니다. 지속적으로 필요한 데이터(자동 로그인 등)는 로컬 스토리지에 저장하고, 잠깐 동안 필요한 정보(일회성 로그인 정보 등)는 세션 스토리지에 저장하면 된다.

두 스토리지는 모두 `window` 객체 안에 들어 있다. `Storage` 객체를 상속받기 때문에 메소드가 공통적으로 존재하며, 도메인 별 용량 제한도 있다. 브라우저 별로, 기기 별로 다르긴 하지만 모바일은 2.5MB, 데스크탑은 5MB~10MB라고 생각하면 된다.

## 2.1 localStorage

- 로컬 스토리지 객체는 **만료 날짜가 없는 데이터를 저장**한다.
- 데이터는 브라우저가 닫힐 때, 삭제되지 않으며 1년 동안이라도 사용할 수 있다.
- 도메인이 다르면 서로의 로컬 스토리지에 접근 불가하다.(예를 들어 구글과 네이버는 서로의 로컬스토리지에 접근 불가능하다.)
- 같은 도메인(프로토콜, 호스트, 포트가 같은 경우를 말함)은 로컬 스토리지를 공유한다.
- `window.localStorage`에 위치한다.
- `key-value` 저장소이기 때문에 키값과 밸류값을 순서대로 저장하면 된다. 값은 `문자열`, `불린(true, false)`, `숫자`, `null`, `undefined` 등을 저장할 수 있지만, 모두 문자열로 변환되며, 키 또한 문자열로 변환된다.

## 2.2 sessionStorage

- 각 세션(하나의 윈도우)마다 **데이터가 별도로 저장**된다.
- 해당 세션이 종료되면 데이터가 사라진다.
- 세션 스토리지의 경우, 같은 도메인에 연결했어도 브라우저 윈도우가 다르면 서로 다른 영역을 사용한다.
- `window.sessionStorage`에 위치한다.

## 2.3 쿠키

- 로컬 스토리지와 세션 스토리지가 나오기 이전에 브라우저에 저장소 역할을 하던 것이다.
- 만료 기한이 있는 `key-value` 저장소이다.
- 4KB의 용량 제한이 있다.
- 매 서버 요청마다 서버로 쿠키가 같이 전송된다.

  💡 왜 서버에 쿠키가 전송될까?

  이를 알기 위해서는 HTTP 요청에 대해서 알아야 한다. HTTP 요청은 상태를 가지고 있지 않은데, 즉, 브라우저에서 서버로 클라이언트에 대한 정보를 가져오라는 `get` 요청을 보낼 때, 서버는 요청 자체만으로는 그 요청이 누구에서 오는 지 알 수 없기 때문에 응답을 보낼 수 없는 것이다.

  이때 쿠키에 클라이언트에 대한 정보를 담아서 서버로 보내면 서버는 쿠키를 읽어서 클라이언트에 대해 파악한다. 쿠키는 처음부터 서버와 클라이언트 간의 지속적인 데이터 교환을 위해 만들어졌기 때문에 서버로 계속 전송되는 것이다.

  하지만 이것이 문제가 되는데, 만약 4KB 용량을 다 채운 쿠키가 있다면, 요청할 때마다 기본 4KB의 데이터를 사용하게 된다. 그 중에는 서버에 필요하지 않은 데이터들도 분명 있는데, 이런 경우에 데이터가 낭비되는 것이고, 바로 그런 데이터를 로컬 스토리지와 세션 스토리지에 저장할 수 있다. 이 두 저장소의 데이터는 서버로 자동 전송되지 않는다.

# 3. 로컬 스토리지 API

`localStorage` 객체는 다음과 같은 메서드를 가지고 있다.

- `length` : 저장된 변수의 개수
- `setItem(key, value)` : key-value를 로컬 스토리지에 저장한다.
- `getItem(key)` : key와 연관된 값을 반환한다.
- `removeItem(key)` : key-value를 로컬 스토리지에 삭제한다.
- `clear()` : 모든 key-value를 삭제한다.
- `JSON.stringify(value)` : 한번에 한 객체를 통째로 저장한다. 객체 형식 그대로 문자열로 변환하는 것이다.
- `JSON.parse(text)` : 위의 stringify를 사용하여 변환된 문자열 객체를 JSON 객체로 변환시켜준다.

# 더 나아가) 어떻게 활용할까?

- 자동 로그인 → `localStorage`
- 입력 폼 정보 → `sessionStorage`
- 비로그인 장바구니 → `sessionStorage`
- 다시 보지 않음 팝업 창 → `쿠키`

---

- 참조

  <HTML5+CSS3+JavaScript로 배우는 웹 프로그래밍 기초> 천인국 저.

  [https://www.zerocho.com/category/HTML&DOM/post/5918515b1ed39f00182d3048](https://www.zerocho.com/category/HTML&DOM/post/5918515b1ed39f00182d3048)

  [https://velog.io/@kler/TIL4-로컬스토리지-세션스토리지-쿠키-정리](https://velog.io/@kler/TIL4-%EB%A1%9C%EC%BB%AC%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80-%EC%84%B8%EC%85%98%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80-%EC%BF%A0%ED%82%A4-%EC%A0%95%EB%A6%AC)
